#include <stdlib.h>
#include <cstdlib>
#include <chrono>
#include <immintrin.h>
#include <iostream>

using namespace std::chrono;
using namespace std;

#define N 10240
#define VAL 50

using namespace std;


static int* getRandArr() {
    auto res = new int[N];
    for (int i = 0; i < N; ++i)
    {
        res[i] = rand() % (VAL * 2);
    }
    return res;
}


int scalar(int* arr)
{
    int cnt = 0;
    for (int i = 0; i < N; ++i)
    {
        if (arr[i] == VAL)
        {
            ++cnt;
        }
    }
    return cnt;
}

int simd(int* arr)
{
    int cnt = 0;
    auto avxVal = _mm256_set1_epi32(VAL);
    for (int i = 0; i < N; i += 8) {
        cnt += _mm_popcnt_u32(_mm256_movemask_epi8(_mm256_cmpeq_epi32(avxVal, _mm256_loadu_si256((__m256i*) & arr[i]))));
    }
    cnt = cnt / 4;
    return cnt;
}
